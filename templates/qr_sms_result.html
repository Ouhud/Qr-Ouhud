{% extends "base.html" %}
{% set lang = request.state.lang if request and request.state else 'de' %}
{% if lang == 'en' %}
  {% set t_title = 'âœ… SMS QR code result' %}
  {% set t_h1 = 'âœ… SMS QR code created!' %}
  {% set t_sub = 'Scan this code to send an SMS directly.' %}
  {% set t_rec = 'Recipient:' %}
  {% set t_msg = 'Message:' %}
  {% set t_open = 'ğŸ“± Open SMS' %}
  {% set t_dyn = 'Dynamic link:' %}
  {% set t_download = 'â¬‡ï¸ Download QR' %}
  {% set t_print = 'ğŸ–¨ï¸ Print QR' %}
  {% set t_edit = 'âœï¸ Edit' %}
{% elif lang == 'ar' %}
  {% set t_title = 'âœ… Ù†ØªÙŠØ¬Ø© QR Ù„Ù„Ø±Ø³Ø§Ø¦Ù„ SMS' %}
  {% set t_h1 = 'âœ… ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ QR Ù„Ù„Ø±Ø³Ø§Ø¦Ù„ SMS!' %}
  {% set t_sub = 'Ø§Ù…Ø³Ø­ Ù‡Ø°Ø§ Ø§Ù„Ø±Ù…Ø² Ù„Ø¥Ø±Ø³Ø§Ù„ Ø±Ø³Ø§Ù„Ø© SMS Ù…Ø¨Ø§Ø´Ø±Ø©.' %}
  {% set t_rec = 'Ø§Ù„Ù…Ø³ØªÙ„Ù…:' %}
  {% set t_msg = 'Ø§Ù„Ø±Ø³Ø§Ù„Ø©:' %}
  {% set t_open = 'ğŸ“± ÙØªØ­ SMS' %}
  {% set t_dyn = 'Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠ:' %}
  {% set t_download = 'â¬‡ï¸ ØªÙ†Ø²ÙŠÙ„ QR' %}
  {% set t_print = 'ğŸ–¨ï¸ Ø·Ø¨Ø§Ø¹Ø© QR' %}
  {% set t_edit = 'âœï¸ ØªØ¹Ø¯ÙŠÙ„' %}
{% else %}
  {% set t_title = 'âœ… SMS-QR-Code Ergebnis' %}
  {% set t_h1 = 'âœ… SMS-QR-Code erstellt!' %}
  {% set t_sub = 'Scanne diesen Code, um direkt eine SMS zu senden.' %}
  {% set t_rec = 'EmpfÃ¤nger:' %}
  {% set t_msg = 'Nachricht:' %}
  {% set t_open = 'ğŸ“± SMS Ã¶ffnen' %}
  {% set t_dyn = 'Dynamischer Link:' %}
  {% set t_download = 'â¬‡ï¸ QR herunterladen' %}
  {% set t_print = 'ğŸ–¨ï¸ QR drucken' %}
  {% set t_edit = 'âœï¸ Bearbeiten' %}
{% endif %}
{% block title %}{{ t_title }}{% endblock %}

{% block content %}
{% include "partials/qr_result_warnings.html" %}
<section class="qr-result qr-result-unified">
  <h1>{{ t_h1 }}</h1>
  <p class="subtitle">{{ t_sub }}</p>

  <div class="qr-card">
    <img src="data:image/png;base64,{{ qr_image }}" alt="QR-Code" class="qr-preview">
    <p><strong>{{ t_rec }}</strong> {{ phone }}</p>
    {% if message %}
    <p><strong>{{ t_msg }}</strong> {{ message }}</p>
    {% endif %}
    {% if dynamic_url %}
    <p class="dyn-link"><strong>{{ t_dyn }}</strong> <a href="{{ dynamic_url }}" target="_blank" rel="noopener">{{ dynamic_url }}</a></p>
    {% endif %}

    <div class="qr-actions">
      <a href="{{ sms }}" class="btn-link">{{ t_open }}</a>
      {% if qr and qr.slug %}
      <a href="/qr/export/{{ qr.slug }}?format=png" class="btn-link">{{ t_download }}</a>
      <button type="button" class="btn-link btn-btn" onclick="return printQrFromSelector('.qr-preview')">{{ t_print }}</button>
      <a href="/qr/edit/{{ qr.slug }}" class="btn-link">{{ t_edit }}</a>
      {% endif %}
    </div>
  </div>
</section>

<style>
.qr-result {
  max-width: 900px;
  margin: 3rem auto;
  background: #fff;
  padding: 2rem;
  border-radius: 20px;
  box-shadow: 0 6px 20px rgba(0,0,0,0.08);
  text-align: center;
  font-family: "Inter", system-ui, sans-serif;
}
.qr-preview {
  max-width: 250px;
  border-radius: 12px;
  margin: 1rem 0;
}
.btn-link {
  display:inline-block;
  margin-top:1rem;
  padding:0.75rem 1.2rem;
  background:linear-gradient(135deg,#0D2A78,#1E40AF);
  color:white;
  text-decoration:none;
  border-radius:10px;
  font-weight:600;
}
.btn-link:hover {background:linear-gradient(135deg,#0B1742,#1E3A8A);}
.qr-actions { display:flex; gap:.6rem; justify-content:center; flex-wrap:wrap; margin-top:.9rem; }
.btn-btn { border:none; cursor:pointer; }
.dyn-link { margin-top:.6rem; font-size:.95rem; word-break:break-all; }
</style>
{% endblock %}
