{# templates/partials/qr_style_panel.html #}
{% set lang = request.state.lang if request and request.state else 'de' %}
{% if lang == 'en' %}
  {% set q_panel_title = 'ğŸ¨ QR Design & Output' %}
  {% set q_panel_sub = 'Choose a style, customize colors, add a logo, and define output size.' %}
  {% set q_styles_title = 'Styles' %}
  {% set q_custom_title = 'âš™ï¸ Custom QR Design' %}
  {% set q_custom_sub = 'Design your QR code to match your brand with colors, logo, and size.' %}
  {% set q_fg = 'QR color (foreground)' %}
  {% set q_bg = 'Background color' %}
  {% set q_size = 'Size (px)' %}
  {% set q_logo = 'Upload logo (optional)' %}
  {% set q_submit_default = 'âœ… Create QR code' %}
  {% set q_print = 'ğŸ–¨ï¸ Print' %}
  {% set q_extra_title = 'âœ¨ Advanced options' %}
  {% set q_extra_sub = 'Enable dynamic QR codes so you can update content later without reprinting.' %}
  {% set q_extra_toggle = 'Enable dynamic QR code' %}
  {% set q_btn_select = 'Select' %}
  {% set q_btn_selected = 'âœ… Selected' %}
{% elif lang == 'ar' %}
  {% set q_panel_title = 'ğŸ¨ ØªØµÙ…ÙŠÙ… QR ÙˆØ§Ù„Ø¥Ø®Ø±Ø§Ø¬' %}
  {% set q_panel_sub = 'Ø§Ø®ØªØ± Ù†Ù…Ø·Ù‹Ø§ØŒ Ø®ØµÙ‘Øµ Ø§Ù„Ø£Ù„ÙˆØ§Ù†ØŒ Ø£Ø¶Ù Ø´Ø¹Ø§Ø±Ù‹Ø§ØŒ ÙˆØ­Ø¯Ø¯ Ø­Ø¬Ù… Ø§Ù„Ø¥Ø®Ø±Ø§Ø¬.' %}
  {% set q_styles_title = 'Ø§Ù„Ø£Ù†Ù…Ø§Ø·' %}
  {% set q_custom_title = 'âš™ï¸ ØªØµÙ…ÙŠÙ… QR Ù…Ø®ØµØµ' %}
  {% set q_custom_sub = 'ØµÙ…Ù‘Ù… Ø±Ù…Ø² QR Ø¨Ù…Ø§ ÙŠÙ†Ø§Ø³Ø¨ Ø¹Ù„Ø§Ù…ØªÙƒ Ø¨Ø§Ù„Ø£Ù„ÙˆØ§Ù† ÙˆØ§Ù„Ø´Ø¹Ø§Ø± ÙˆØ§Ù„Ø­Ø¬Ù….' %}
  {% set q_fg = 'Ù„ÙˆÙ† QR (Ø§Ù„Ø£Ù…Ø§Ù…ÙŠ)' %}
  {% set q_bg = 'Ù„ÙˆÙ† Ø§Ù„Ø®Ù„ÙÙŠØ©' %}
  {% set q_size = 'Ø§Ù„Ø­Ø¬Ù… (px)' %}
  {% set q_logo = 'Ø±ÙØ¹ Ø´Ø¹Ø§Ø± (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)' %}
  {% set q_submit_default = 'âœ… Ø¥Ù†Ø´Ø§Ø¡ Ø±Ù…Ø² QR' %}
  {% set q_print = 'ğŸ–¨ï¸ Ø·Ø¨Ø§Ø¹Ø©' %}
  {% set q_extra_title = 'âœ¨ Ø®ÙŠØ§Ø±Ø§Øª Ù…ØªÙ‚Ø¯Ù…Ø©' %}
  {% set q_extra_sub = 'ÙØ¹Ù‘Ù„ QR Ø§Ù„Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠ Ù„ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ù„Ø§Ø­Ù‚Ù‹Ø§ Ø¨Ø¯ÙˆÙ† Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø·Ø¨Ø§Ø¹Ø©.' %}
  {% set q_extra_toggle = 'ØªÙØ¹ÙŠÙ„ QR Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠ' %}
  {% set q_btn_select = 'Ø§Ø®ØªÙŠØ§Ø±' %}
  {% set q_btn_selected = 'âœ… ØªÙ… Ø§Ù„Ø§Ø®ØªÙŠØ§Ø±' %}
{% else %}
  {% set q_panel_title = 'ğŸ¨ QR-Design & Ausgabe' %}
  {% set q_panel_sub = 'WÃ¤hle ein Design, passe Farben an, setze ein Logo und lege die AusgabegrÃ¶ÃŸe fest.' %}
  {% set q_styles_title = 'Stile' %}
  {% set q_custom_title = 'âš™ï¸ Individuelles QR-Code-Design' %}
  {% set q_custom_sub = 'Gestalte deinen QR-Code nach deinen Vorstellungen â€“ Farben, Logo und GrÃ¶ÃŸe perfekt auf deine Marke abgestimmt.' %}
  {% set q_fg = 'QR-Farbe (Vordergrund)' %}
  {% set q_bg = 'Hintergrundfarbe' %}
  {% set q_size = 'GrÃ¶ÃŸe px' %}
  {% set q_logo = 'Logo hochladen (optional)' %}
  {% set q_submit_default = 'âœ… QR-Code erstellen' %}
  {% set q_print = 'ğŸ–¨ï¸ Drucken' %}
  {% set q_extra_title = 'âœ¨ Erweiterte Optionen' %}
  {% set q_extra_sub = 'Aktiviere dynamische QR-Codes, die du spÃ¤ter anpassen kannst â€“ ohne neue Drucke.' %}
  {% set q_extra_toggle = 'Dynamischer QR-Code aktivieren' %}
  {% set q_btn_select = 'AuswÃ¤hlen' %}
  {% set q_btn_selected = 'âœ… AusgewÃ¤hlt' %}
{% endif %}

<section class="qr-style-panel" aria-labelledby="qr-style-panel-title">
  <h2 id="qr-style-panel-title" class="qrsp-title">
    {{ q_panel_title }}
  </h2>
  <p class="qrsp-subtitle">
    {{ q_panel_sub }}
  </p>

  <!-- Hidden: STYLE-Key fÃ¼r Backend -->
  <input type="hidden" id="selected_style" name="style" value="{{ default_style|default('classic') }}">

  <div class="qrsp-grid">
    <!-- ========== Stil-Raster ========== -->
    <div class="qrsp-card">
      <h3 class="qrsp-card-title">{{ q_styles_title }}</h3>

{% if lang == 'en' %}
{% set styles = [
  {"name":"Classic","key":"classic","img":"classic.png","desc":"Standard - high contrast and universal readability"},
  {"name":"Rounded","key":"rounded","img":"rounded.png","desc":"Modern soft corners"},
  {"name":"Dots","key":"dots","img":"dots.png","desc":"Creative dot pattern"},
  {"name":"Soft Modern","key":"soft","img":"soft.png","desc":"Minimal and elegant"},
  {"name":"Gradient","key":"gradient","img":"gradient.png","desc":"Color gradient"},
  {"name":"Premium","key":"premium","img":"premium.png","desc":"Luxury gold style"},
  {"name":"Neon","key":"neon","img":"neon.png","desc":"Glowing effect"},
  {"name":"Dark Mode","key":"dark","img":"dark.png","desc":"Great for dark backgrounds"},
  {"name":"Sunset","key":"sunset","img":"sunset.png","desc":"Orange to red"},
  {"name":"Ocean","key":"ocean","img":"ocean.png","desc":"Blue gradient"},
  {"name":"Forest","key":"forest","img":"forest.png","desc":"Natural green"},
  {"name":"Rose Gold","key":"rose","img":"rose.png","desc":"Pink and gold"},
  {"name":"3D Blue","key":"3d_pro","img":"3d_pro.png","desc":"Deep 3D metallic shine"},
  {"name":"Metallic","key":"metallic","img":"metallic.png","desc":"Steel look"},
  {"name":"Glass Effect","key":"glass","img":"glass.png","desc":"Glass style"},
  {"name":"Futuristic","key":"futuristic","img":"futuristic.png","desc":"Neon lines"},
  {"name":"Hologram","key":"holo","img":"holo.png","desc":"Hologram pastel"},
  {"name":"Ouhud Brand","key":"ouhud","img":"ouhud.png","desc":"Ouhud blue with glow"}
] %}
{% elif lang == 'ar' %}
{% set styles = [
  {"name":"ÙƒÙ„Ø§Ø³ÙŠÙƒÙŠ","key":"classic","img":"classic.png","desc":"Ù‚ÙŠØ§Ø³ÙŠ - ØªØ¨Ø§ÙŠÙ† Ù‚ÙˆÙŠ ÙˆÙ‚Ø±Ø§Ø¡Ø© Ù…Ù…ØªØ§Ø²Ø©"},
  {"name":"Ø­ÙˆØ§Ù Ø¯Ø§Ø¦Ø±ÙŠØ©","key":"rounded","img":"rounded.png","desc":"Ø²ÙˆØ§ÙŠØ§ Ù†Ø§Ø¹Ù…Ø© ÙˆØ¹ØµØ±ÙŠØ©"},
  {"name":"Ù†Ù‚Ø§Ø·","key":"dots","img":"dots.png","desc":"Ù†Ù…Ø· Ù†Ù‚Ø§Ø· Ø¥Ø¨Ø¯Ø§Ø¹ÙŠ"},
  {"name":"Ø¹ØµØ±ÙŠ Ù†Ø§Ø¹Ù…","key":"soft","img":"soft.png","desc":"Ø¨Ø³ÙŠØ· ÙˆØ£Ù†ÙŠÙ‚"},
  {"name":"ØªØ¯Ø±Ù‘Ø¬","key":"gradient","img":"gradient.png","desc":"ØªØ¯Ø±Ù‘Ø¬ Ù„ÙˆÙ†ÙŠ"},
  {"name":"Ø¨Ø±ÙŠÙ…ÙŠÙˆÙ…","key":"premium","img":"premium.png","desc":"ØªØµÙ…ÙŠÙ… Ø°Ù‡Ø¨ÙŠ ÙØ§Ø®Ø±"},
  {"name":"Ù†ÙŠÙˆÙ†","key":"neon","img":"neon.png","desc":"ØªØ£Ø«ÙŠØ± Ù…Ø¶ÙŠØ¡"},
  {"name":"Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ø¯Ø§ÙƒÙ†","key":"dark","img":"dark.png","desc":"Ù…Ø«Ø§Ù„ÙŠ Ù„Ù„Ø®Ù„ÙÙŠØ§Øª Ø§Ù„Ø¯Ø§ÙƒÙ†Ø©"},
  {"name":"ØºØ±ÙˆØ¨","key":"sunset","img":"sunset.png","desc":"Ø¨Ø±ØªÙ‚Ø§Ù„ÙŠ Ø¥Ù„Ù‰ Ø£Ø­Ù…Ø±"},
  {"name":"Ù…Ø­ÙŠØ·","key":"ocean","img":"ocean.png","desc":"ØªØ¯Ø±Ù‘Ø¬ Ø£Ø²Ø±Ù‚"},
  {"name":"ØºØ§Ø¨Ø©","key":"forest","img":"forest.png","desc":"Ø£Ø®Ø¶Ø± Ø·Ø¨ÙŠØ¹ÙŠ"},
  {"name":"Ø±ÙˆØ² ØºÙˆÙ„Ø¯","key":"rose","img":"rose.png","desc":"ÙˆØ±Ø¯ÙŠ ÙˆØ°Ù‡Ø¨ÙŠ"},
  {"name":"Ø£Ø²Ø±Ù‚ 3D","key":"3d_pro","img":"3d_pro.png","desc":"Ù„Ù…Ø¹Ø© Ù…Ø¹Ø¯Ù†ÙŠØ© Ø«Ù„Ø§Ø«ÙŠØ© Ø§Ù„Ø£Ø¨Ø¹Ø§Ø¯"},
  {"name":"Ù…Ø¹Ø¯Ù†ÙŠ","key":"metallic","img":"metallic.png","desc":"Ù…Ø¸Ù‡Ø± ÙÙˆÙ„Ø§Ø°ÙŠ"},
  {"name":"ØªØ£Ø«ÙŠØ± Ø²Ø¬Ø§Ø¬ÙŠ","key":"glass","img":"glass.png","desc":"Ù…Ø¸Ù‡Ø± Ø§Ù„Ø²Ø¬Ø§Ø¬"},
  {"name":"Ù…Ø³ØªÙ‚Ø¨Ù„ÙŠ","key":"futuristic","img":"futuristic.png","desc":"Ø®Ø·ÙˆØ· Ù†ÙŠÙˆÙ†"},
  {"name":"Ù‡ÙˆÙ„ÙˆØºØ±Ø§Ù…","key":"holo","img":"holo.png","desc":"Ø£Ù„ÙˆØ§Ù† Ù‡ÙˆÙ„ÙˆØºØ±Ø§Ù… Ø¨Ø§Ø³ØªÙŠÙ„"},
  {"name":"Ù‡ÙˆÙŠØ© Ouhud","key":"ouhud","img":"ouhud.png","desc":"Ø£Ø²Ø±Ù‚ Ouhud Ù…Ø¹ ØªÙˆÙ‡Ø¬"}
] %}
{% else %}
{% set styles = [
  {"name":"Klassisch","key":"classic","img":"classic.png","desc":"Standard â€“ kontrastreich und universell lesbar"},
  {"name":"Abgerundet","key":"rounded","img":"rounded.png","desc":"Moderne, weiche Kanten"},
  {"name":"Punkte","key":"dots","img":"dots.png","desc":"Kreatives Punktmuster"},
  {"name":"Soft Modern","key":"soft","img":"soft.png","desc":"Minimal & elegant"},
  {"name":"Gradient","key":"gradient","img":"gradient.png","desc":"Farbverlauf"},
  {"name":"Premium","key":"premium","img":"premium.png","desc":"LuxuriÃ¶ses Gold-Design"},
  {"name":"Neon","key":"neon","img":"neon.png","desc":"Leuchtender Effekt"},
  {"name":"Dark Mode","key":"dark","img":"dark.png","desc":"Perfekt fÃ¼r dunkle HintergrÃ¼nde"},
  {"name":"Sunset","key":"sunset","img":"sunset.png","desc":"Orange â†’ Rot"},
  {"name":"Ocean","key":"ocean","img":"ocean.png","desc":"Blauer Verlauf"},
  {"name":"Forest","key":"forest","img":"forest.png","desc":"NatÃ¼rliches GrÃ¼n"},
  {"name":"Rose Gold","key":"rose","img":"rose.png","desc":"Rosa & Gold"},
  {"name":"3D Blau","key":"3d_pro","img":"3d_pro.png","desc":"Tiefer 3D-Metallglanz"},
  {"name":"Metallisch","key":"metallic","img":"metallic.png","desc":"Stahl-Look"},
  {"name":"Glas Effekt","key":"glass","img":"glass.png","desc":"Glas-Optik"},
  {"name":"Futuristisch","key":"futuristic","img":"futuristic.png","desc":"Neonlinien"},
  {"name":"Hologramm","key":"holo","img":"holo.png","desc":"Hologramm-Pastell"},
  {"name":"Ouhud Brand","key":"ouhud","img":"ouhud.png","desc":"Ouhud Blue mit Glow"}
] %}
{% endif %}

    <!-- === Style Grid === -->
    <div class="style-grid">
      {% for style in styles %}
      <div class="style-card">
        <div class="preview">
          <img src="/static/style_previews/{{ style.img }}" alt="{{ style.name }}">
        </div>
        <h3>{{ style.name }}</h3>
        <p class="desc">{{ style.desc }}</p>
        <button type="button" class="btn primary style-btn" data-style="{{ style.key }}"
                onclick="selectStyle(event, '{{ style.key }}')">{{ q_btn_select }}</button>
      </div>
      {% endfor %}
    </div>
    </div>
  </div>
</section>

<!-- âœ… Professionelles Custom-Design Panel -->
<section class="custom-design">
  <div class="design-container">

    <h2 class="section-title">
      <span class="icon-gear">âš™ï¸</span> {{ q_custom_title|replace('âš™ï¸ ', '') }}
    </h2>

    <p class="section-subtitle">
      {{ q_custom_sub }}
    </p>

    <div id="designForm">

      <!-- GRID 2-spaltig -->
      <div class="design-grid">

              <div class="form-group">
                <label>{{ q_fg }}</label>
                <input type="color" id="fg_color" name="fg_color" value="#0d2a78" class="text-input"> 
              </div>

              <div class="form-group">
                <label>{{ q_bg }}</label>
                <input type="color" id="bg_color" name="bg_color" value="#ffffff" class="text-input">
              </div>

              <div class="form-group">
                <label>{{ q_size }}</label>
                <input type="number" id="qr_size" name="qr_size" min="200" max="1000" value="300" class="input-field text-input">
              </div>

              {% if show_logo_upload|default(true) %}
              <div class="form-group">
                <label>{{ q_logo }}</label>
                <input type="file" id="logo" name="logo" accept="image/*" class="input-file">
              </div>
              {% endif %}

            </div>

      <!-- BUTTONS -->
      {% if include_submit|default(true) %}
      <div class="action-buttons">
        <button type="submit" class="btn primary">
          {{ submit_label|default(q_submit_default) }}
        </button>

        {% if include_print|default(true) %}
        <button type="button" class="btn gray" onclick="printQR()">
          {{ q_print }}
        </button>
        {% endif %}
      </div>
      {% endif %}

      <!-- ERWEITERTE OPTIONEN -->
      <div class="extra-actions">
        <h3>{{ q_extra_title }}</h3>
        <p class="desc">
          {{ q_extra_sub }}
        </p>

        <input type="hidden" id="dynamicQR" name="dynamicQR" value="1">
        <label class="toggle" for="dynamicQR_toggle">
          <input type="checkbox" id="dynamicQR_toggle" checked>
          <span class="toggle-slider"></span>
          <span class="toggle-label">{{ q_extra_toggle }}</span>
        </label>
      </div>

    </div>
  </div>
</section>

<style>
:root {
  --primary: #0d2a78;
  --primary-dark: #0b1f5e;
  --light: #f8fafc;
  --text: #1e293b;
  --muted: #64748b;
}

/* === Layout & Farben === */
.qr-style-section {
  background: var(--light);
  padding: 4rem 1.5rem;
  text-align: center;
}
.qr-style-section h1 {
  color: var(--primary);
  font-size: 2rem;
  font-weight: 700;
  margin-bottom: .5rem;
}
.qr-style-section .subtitle {
  color: var(--muted);
  margin-bottom: 2.5rem;
  font-size: 1rem;
}

/* === Style Grid === */
.qr-style-panel .style-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
  gap: 1.5rem;
  max-width: 950px;
  margin: 0 auto;
}

/* âœ… EINHEITLICHE KARTENGRÃ–SSE */
.qr-style-panel .style-card {
  background: #fff;
  border-radius: 1rem;
  padding: 1rem;
  box-shadow: 0 2px 10px rgba(13, 42, 120, 0.08);
  text-align: center;
  transition: all 0.25s ease;

  /* Wichtig */
  display: flex;
  flex-direction: column;
  justify-content: space-between;
  height: 340px; /* gleiche HÃ¶he fÃ¼r alle Karten */
}
.qr-style-panel .style-card:hover {
  transform: translateY(-4px);
  box-shadow: 0 8px 20px rgba(13, 42, 120, 0.15);
}

/* âœ… Einheitliche BildhÃ¶he */
.qr-style-panel .style-card .preview img {
  width: 100%;
  height: 140px;
  object-fit: contain;
  border-radius: .6rem;
  margin-bottom: .8rem;
}

/* âœ… Einheitliche Text-HÃ¶hen (Titel & Beschreibung) */
.qr-style-panel .style-card h3 {
  color: var(--primary);
  font-weight: 600;
  min-height: 28px; /* gleiche HÃ¶he */
}
.qr-style-panel .style-card .desc {
  color: #475569;
  font-size: .9rem;
  margin-bottom: 1rem;
  min-height: 38px; /* gleiche HÃ¶he */
}

/* âœ… Button immer unten */
.qr-style-panel .style-card .btn {
  margin-top: auto;
}

/* === Formular & Buttons === */
.custom-design {
  background: #fff;
  border-radius: 1.4rem;
  padding: 2.2rem 2.2rem 1.2rem;
  max-width: 940px;
  margin: 2rem auto 0.75rem;
  box-shadow: 0 10px 35px rgba(13, 42, 120, 0.08);
  text-align: center;
}
.custom-design:last-of-type {
  margin-bottom: 0;
}
.custom-design .design-grid {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 1rem 1.5rem;
  text-align: left;
  margin-bottom: 2rem;
  align-items: start;
}
.custom-design .design-grid .form-group {
  display: flex;
  flex-direction: column;
  gap: 0.45rem;
  min-width: 0;
}
.custom-design .design-grid label {
  display: block;
  font-weight: 600;
  color: var(--primary);
  margin-bottom: 0;
}
.color-input,
.text-input,
.input-field,
.input-file
{
  box-sizing: border-box;
  display: block;
  width: 100%;
  max-width: 100%;
  min-height: 56px;
  height: 56px;               /* Einheitliche HÃ¶he fÃ¼r alle Felder */
  padding: 10px 12px;
  border: 1.5px solid #c7d2fe;
  border-radius: 10px;
  background: #ffffff;
  transition: border-color 0.25s ease, box-shadow 0.25s ease;
}
.color-input:focus,
.input-file:focus,
.text-input:focus {
  border-color: var(--primary);
  box-shadow: 0 0 0 3px rgba(13, 42, 120, 0.15);
  outline: none;
}


/* Spezielle Anpassung fÃ¼r das Datei-Feld (Logo hochladen) */
.input-file {
  padding: 7px 10px;
  line-height: normal;
}
.input-file::file-selector-button {
  border: 1px solid #93c5fd;
  background: #eff6ff;
  color: #1e3a8a;
  border-radius: 8px;
  padding: 8px 12px;
  margin-right: 10px;
  font-weight: 600;
  cursor: pointer;
}
.input-file::-webkit-file-upload-button {
  border: 1px solid #93c5fd;
  background: #eff6ff;
  color: #1e3a8a;
  border-radius: 8px;
  padding: 8px 12px;
  margin-right: 10px;
  font-weight: 600;
  cursor: pointer;
}
input[type="color"].text-input {
  -webkit-appearance: none;
  appearance: none;
  padding: 4px;
  cursor: pointer;
}

/* Spezielle Anpassung fÃ¼r das Zahlenfeld (GrÃ¶ÃŸe) */
.input-field {
  padding: 0 12px;
}


/* === Buttons === */
.custom-design .action-buttons {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 0.8rem;
}
.custom-design .btn,
.qr-style-panel .btn {
  box-sizing: border-box;
  width: 100%;
  max-width: 320px;
  height: 52px;
  border-radius: 0.9rem;
  font-weight: 600;
  border: 2px solid var(--primary);
  cursor: pointer;
  transition: all 0.25s ease;
}
.custom-design .btn.primary,
.qr-style-panel .btn.primary { 
  background: var(--primary); 
  color: #fff; 
}
.custom-design .btn.primary:hover,
.qr-style-panel .btn.primary:hover { 
  background: var(--primary-dark); 
  transform: translateY(-2px); 
}
.qr-style-panel .style-btn.active {
  background: var(--primary-dark);
  color: #fff;
}
.custom-design .btn.edit,
.custom-design .btn.secondary,
.qr-style-panel .btn.edit,
.qr-style-panel .btn.secondary { 
  background: var(--primary); 
  color: #fff; 
}
.custom-design .btn.edit:hover,
.custom-design .btn.secondary:hover,
.qr-style-panel .btn.edit:hover,
.qr-style-panel .btn.secondary:hover { 
  background: var(--primary-dark); 
  color: #fff; 
}

.custom-design .extra-actions {
  margin-top: 1.25rem;
  margin-bottom: 0;
  border: 1px solid #dbeafe;
  border-radius: 14px;
  background: #f8fbff;
  padding: 0.9rem;
  text-align: left;
}
.custom-design .extra-actions h3 {
  margin: 0 0 0.35rem;
  color: #0d2a78;
}
.custom-design .extra-actions .desc {
  margin: 0 0 0.8rem;
  color: #475569;
}
.custom-design .toggle {
  display: grid;
  grid-template-columns: auto 1fr;
  align-items: center;
  gap: 0.6rem;
  position: relative;
  cursor: pointer;
}
.custom-design .toggle input[type="checkbox"] {
  position: absolute;
  width: 1px;
  height: 1px;
  margin: 0;
  padding: 0;
  border: 0;
  overflow: hidden;
  white-space: nowrap;
  clip: rect(0 0 0 0);
  clip-path: inset(50%);
}
.custom-design .toggle-slider {
  width: 46px;
  height: 26px;
  border-radius: 999px;
  background: #cbd5e1;
  position: relative;
  transition: background 0.2s ease;
}
.custom-design .toggle-slider::after {
  content: "";
  position: absolute;
  width: 20px;
  height: 20px;
  border-radius: 50%;
  background: #fff;
  top: 3px;
  left: 3px;
  transition: transform 0.2s ease;
  box-shadow: 0 1px 4px rgba(2, 6, 23, 0.25);
}
.custom-design .toggle input[type="checkbox"]:checked + .toggle-slider {
  background: #2563eb;
}
.custom-design .toggle input[type="checkbox"]:checked + .toggle-slider::after {
  transform: translateX(20px);
}
.custom-design .toggle-label {
  font-weight: 600;
  color: #1e293b;
}


/* Zahl-Pfeile entfernen (Chrome, Edge, Safari) */
input[type=number]::-webkit-inner-spin-button,
input[type=number]::-webkit-outer-spin-button {
  -webkit-appearance: none;
  margin: 0;
}

/* Zahl-Pfeile in Firefox entfernen */
input[type=number] {
  -moz-appearance: textfield;
}

/* Responsive */
@media (max-width: 650px) {
  .custom-design .design-grid { grid-template-columns: 1fr; }
  .qr-style-panel .style-card { height: 350px; }
  .custom-design .btn,
  .qr-style-panel .btn { max-width: 100%; }
  .custom-design {
    padding: 1.4rem 1rem 0.9rem;
    margin: 1.2rem auto 0.5rem;
  }
}
</style>
<script>
const STYLE_BTN_SELECT_TEXT = {{ q_btn_select | tojson }};
const STYLE_BTN_SELECTED_TEXT = {{ q_btn_selected | tojson }};

if (!window.printQR) {
  window.printQR = function () {
    window.print();
  };
}

if (!window.selectStyle) {
  window.selectStyle = function (event, styleName) {
    const hidden = document.getElementById("selected_style");
    if (hidden) hidden.value = styleName;

    const legacy = document.getElementById("selectedStyle");
    if (legacy) legacy.value = styleName;

    document.querySelectorAll(".style-btn").forEach((btn) => {
      btn.classList.remove("active");
      if (btn.dataset && btn.dataset.style) {
        btn.textContent = STYLE_BTN_SELECT_TEXT;
      }
    });

    const target =
      (event && event.currentTarget) ||
      document.querySelector(`.style-btn[data-style="${styleName}"]`);
    if (target) {
      target.classList.add("active");
      target.textContent = STYLE_BTN_SELECTED_TEXT;
    }
  };
}

document.addEventListener("DOMContentLoaded", () => {
  const hidden = document.getElementById("selected_style");
  if (hidden && hidden.value) {
    const btn = document.querySelector(
      `.style-btn[data-style="${hidden.value}"]`
    );
    if (btn && !btn.classList.contains("active")) {
      btn.classList.add("active");
      btn.textContent = STYLE_BTN_SELECTED_TEXT;
    }
  }

  const dynamicHidden = document.getElementById("dynamicQR");
  const dynamicToggle = document.getElementById("dynamicQR_toggle");
  if (dynamicHidden && dynamicToggle) {
    dynamicHidden.value = dynamicToggle.checked ? "1" : "0";
    dynamicToggle.addEventListener("change", () => {
      const mainScroller = document.querySelector("main.main-content");
      const pageY = window.scrollY;
      const mainY = mainScroller ? mainScroller.scrollTop : 0;
      dynamicHidden.value = dynamicToggle.checked ? "1" : "0";
      requestAnimationFrame(() => {
        if (mainScroller) {
          mainScroller.scrollTop = mainY;
        } else {
          window.scrollTo(0, pageY);
        }
      });
    });
  }
});
</script>
