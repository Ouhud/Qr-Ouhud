{% extends "base.html" %}
{% set lang = request.state.lang if request and request.state else 'de' %}
{% if lang == 'en' %}
  {% set p_title = 'Team Workspaces' %}
  {% set h1 = 'ğŸ‘¥ Team Workspaces & Sharing' %}
  {% set s_new = 'Create new workspace' %}
  {% set s_name = 'Name *' %}
  {% set s_desc = 'Description' %}
  {% set s_create = 'Create workspace' %}
  {% set s_owned = 'My workspaces' %}
  {% set s_add = 'Add member' %}
  {% set s_pick_qr = 'Select QR' %}
  {% set s_assign = 'Assign QR' %}
  {% set s_none_owned = 'No owned workspaces.' %}
  {% set s_member = 'Member in workspaces' %}
  {% set s_role = 'Role' %}
  {% set s_none_member = 'No memberships.' %}
  {% set s_share = 'Share QR directly' %}
  {% set s_target = 'Target email' %}
  {% set s_share_btn = 'Share' %}
{% elif lang == 'ar' %}
  {% set p_title = 'Ù…Ø³Ø§Ø­Ø§Øª Ø¹Ù…Ù„ Ø§Ù„ÙØ±ÙŠÙ‚' %}
  {% set h1 = 'ğŸ‘¥ Ù…Ø³Ø§Ø­Ø§Øª Ø¹Ù…Ù„ Ø§Ù„ÙØ±ÙŠÙ‚ ÙˆØ§Ù„Ù…Ø´Ø§Ø±ÙƒØ©' %}
  {% set s_new = 'Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø³Ø§Ø­Ø© Ø¹Ù…Ù„ Ø¬Ø¯ÙŠØ¯Ø©' %}
  {% set s_name = 'Ø§Ù„Ø§Ø³Ù… *' %}
  {% set s_desc = 'Ø§Ù„ÙˆØµÙ' %}
  {% set s_create = 'Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø³Ø§Ø­Ø© Ø§Ù„Ø¹Ù…Ù„' %}
  {% set s_owned = 'Ù…Ø³Ø§Ø­Ø§Øª Ø§Ù„Ø¹Ù…Ù„ Ø§Ù„Ø®Ø§ØµØ© Ø¨ÙŠ' %}
  {% set s_add = 'Ø¥Ø¶Ø§ÙØ© Ø¹Ø¶Ùˆ' %}
  {% set s_pick_qr = 'Ø§Ø®ØªØ± QR' %}
  {% set s_assign = 'Ø±Ø¨Ø· QR' %}
  {% set s_none_owned = 'Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ø³Ø§Ø­Ø§Øª Ø¹Ù…Ù„ Ù…Ù…Ù„ÙˆÙƒØ©.' %}
  {% set s_member = 'Ø¹Ø¶Ùˆ ÙÙŠ Ù…Ø³Ø§Ø­Ø§Øª Ø§Ù„Ø¹Ù…Ù„' %}
  {% set s_role = 'Ø§Ù„Ø¯ÙˆØ±' %}
  {% set s_none_member = 'Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¹Ø¶ÙˆÙŠØ§Øª.' %}
  {% set s_share = 'Ù…Ø´Ø§Ø±ÙƒØ© QR Ù…Ø¨Ø§Ø´Ø±Ø©' %}
  {% set s_target = 'Ø¨Ø±ÙŠØ¯ Ø§Ù„Ù‡Ø¯Ù' %}
  {% set s_share_btn = 'Ù…Ø´Ø§Ø±ÙƒØ©' %}
{% else %}
  {% set p_title = 'Team Workspaces' %}
  {% set h1 = 'ğŸ‘¥ Team Workspaces & Freigaben' %}
  {% set s_new = 'Neuen Workspace erstellen' %}
  {% set s_name = 'Name *' %}
  {% set s_desc = 'Beschreibung' %}
  {% set s_create = 'Workspace erstellen' %}
  {% set s_owned = 'Meine Workspaces' %}
  {% set s_add = 'Mitglied hinzufÃ¼gen' %}
  {% set s_pick_qr = 'QR waehlen' %}
  {% set s_assign = 'QR zuordnen' %}
  {% set s_none_owned = 'Keine eigenen Workspaces.' %}
  {% set s_member = 'Mitglied in Workspaces' %}
  {% set s_role = 'Rolle' %}
  {% set s_none_member = 'Keine Mitgliedschaften.' %}
  {% set s_share = 'QR direkt freigeben' %}
  {% set s_target = 'Ziel-E-Mail' %}
  {% set s_share_btn = 'Freigeben' %}
{% endif %}
{% block title %}{{ p_title }}{% endblock %}
{% block content %}
<section class="qr-generator" style="max-width:980px;">
  <h1>{{ h1 }}</h1>

  <div class="qr-form">
    <h2>{{ s_new }}</h2>
    <form method="post" action="/team/workspaces/create">
      <label>{{ s_name }}</label><input type="text" name="name" required>
      <label>{{ s_desc }}</label><input type="text" name="description">
      <button class="btn-primary" type="submit">{{ s_create }}</button>
    </form>
  </div>

  <div class="qr-form">
    <h2>{{ s_owned }}</h2>
    {% if owned %}
      <ul>
      {% for w in owned %}
        <li><strong>{{ w.name }}</strong> (Owner)
          <form method="post" action="/team/workspaces/{{ w.id }}/members/add" style="margin-top:.5rem;">
            <input type="email" name="email" placeholder="user@email.com" required>
            <select name="role"><option>viewer</option><option>editor</option><option>admin</option></select>
            <button type="submit" class="btn-secondary">{{ s_add }}</button>
          </form>
          <form method="post" action="/team/workspaces/{{ w.id }}/qrs/assign" style="margin-top:.4rem;">
            <select name="qr_slug" required>
              <option value="">{{ s_pick_qr }}</option>
              {% for qr in my_qrs %}
                <option value="{{ qr.slug }}">{{ qr.title or ('QR ' ~ qr.slug) }} ({{ qr.type }})</option>
              {% endfor %}
            </select>
            <button type="submit" class="btn-secondary">{{ s_assign }}</button>
          </form>
        </li>
      {% endfor %}
      </ul>
    {% else %}
      <p>{{ s_none_owned }}</p>
    {% endif %}
  </div>

  <div class="qr-form">
    <h2>{{ s_member }}</h2>
    {% if member_of %}
      <ul>
      {% for w in member_of %}
        <li><strong>{{ w.name }}</strong> â€“ {{ s_role }}: {{ role_map.get(w.id, 'viewer') }}</li>
      {% endfor %}
      </ul>
    {% else %}
      <p>{{ s_none_member }}</p>
    {% endif %}
  </div>

  <div class="qr-form">
    <h2>{{ s_share }}</h2>
    <form method="post" action="/team/share">
      <label>QR</label>
      <select name="qr_slug" required>
        <option value="">{{ s_pick_qr }}</option>
        {% for qr in my_qrs %}
          <option value="{{ qr.slug }}">{{ qr.title or ('QR ' ~ qr.slug) }} ({{ qr.type }})</option>
        {% endfor %}
      </select>
      <label>{{ s_target }}</label><input type="email" name="user_email" required>
      <label>{{ s_role }}</label>
      <select name="role"><option>viewer</option><option>editor</option><option>admin</option></select>
      <button class="btn-primary" type="submit">{{ s_share_btn }}</button>
    </form>
  </div>
</section>
{% endblock %}
