{% extends "base.html" %}
{% set lang = request.state.lang if request and request.state else 'de' %}
{% if lang == 'en' %}
  {% set t_title = 'ğŸ’³ Subscription & Plans â€“ Ouhud QR' %}
  {% set t_h1 = 'ğŸ’³ Subscription & Plans' %}
  {% set t_sub = 'Manage your current plan, extend your subscription, or upgrade.' %}
  {% set t_current = 'ğŸ”¹ Current plan' %}
  {% set t_status = 'Status:' %}
  {% set t_active = 'âœ… Active' %}
  {% set t_cancelled = 'ğŸš« Cancelled' %}
  {% set t_pending = 'â³ Pending' %}
  {% set t_exp = 'Expiry date:' %}
  {% set t_no_exp = 'â€” No expiry date â€”' %}
  {% set t_upgrade = 'ğŸš€ Upgrade plan' %}
  {% set t_cancel = 'âŒ Cancel subscription' %}
  {% set t_basic = ['Up to 10 QR codes', 'Standard designs', 'Basic management'] %}
  {% set t_pro = ['Up to 50 QR codes', 'All design styles', 'Logo and color options'] %}
  {% set t_business = ['Up to 250 QR codes', 'API access', 'Team management'] %}
{% elif lang == 'ar' %}
  {% set t_title = 'ğŸ’³ Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ ÙˆØ§Ù„Ø¨Ø§Ù‚Ø§Øª â€“ Ouhud QR' %}
  {% set t_h1 = 'ğŸ’³ Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ ÙˆØ§Ù„Ø¨Ø§Ù‚Ø§Øª' %}
  {% set t_sub = 'Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¨Ø§Ù‚Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ©ØŒ ØªÙ…Ø¯ÙŠØ¯ Ø§Ù„Ø§Ø´ØªØ±Ø§ÙƒØŒ Ø£Ùˆ Ø§Ù„ØªØ±Ù‚ÙŠØ©.' %}
  {% set t_current = 'ğŸ”¹ Ø§Ù„Ø¨Ø§Ù‚Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ©' %}
  {% set t_status = 'Ø§Ù„Ø­Ø§Ù„Ø©:' %}
  {% set t_active = 'âœ… Ù†Ø´Ø·' %}
  {% set t_cancelled = 'ğŸš« Ù…ÙÙ„ØºÙ‰' %}
  {% set t_pending = 'â³ Ù‚ÙŠØ¯ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±' %}
  {% set t_exp = 'ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§Ù†ØªÙ‡Ø§Ø¡:' %}
  {% set t_no_exp = 'â€” Ø¨Ø¯ÙˆÙ† ØªØ§Ø±ÙŠØ® Ø§Ù†ØªÙ‡Ø§Ø¡ â€”' %}
  {% set t_upgrade = 'ğŸš€ ØªØ±Ù‚ÙŠØ© Ø§Ù„Ø¨Ø§Ù‚Ø©' %}
  {% set t_cancel = 'âŒ Ø¥Ù„ØºØ§Ø¡ Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ' %}
  {% set t_basic = ['Ø­ØªÙ‰ 10 Ø±Ù…ÙˆØ² QR', 'ØªØµØ§Ù…ÙŠÙ… Ù‚ÙŠØ§Ø³ÙŠØ©', 'Ø¥Ø¯Ø§Ø±Ø© Ø£Ø³Ø§Ø³ÙŠØ©'] %}
  {% set t_pro = ['Ø­ØªÙ‰ 50 Ø±Ù…Ø² QR', 'ÙƒÙ„ Ø£Ù†Ù…Ø§Ø· Ø§Ù„ØªØµÙ…ÙŠÙ…', 'Ø®ÙŠØ§Ø±Ø§Øª Ø§Ù„Ø´Ø¹Ø§Ø± ÙˆØ§Ù„Ø£Ù„ÙˆØ§Ù†'] %}
  {% set t_business = ['Ø­ØªÙ‰ 250 Ø±Ù…Ø² QR', 'ÙˆØµÙˆÙ„ API', 'Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ÙØ±ÙŠÙ‚'] %}
{% else %}
  {% set t_title = 'ğŸ’³ Abonnement & Tarife â€“ Ouhud QR' %}
  {% set t_h1 = 'ğŸ’³ Abonnement & Tarife' %}
  {% set t_sub = 'Verwalte deinen aktuellen Tarif, verlÃ¤ngere dein Abo oder fÃ¼hre ein Upgrade durch.' %}
  {% set t_current = 'ğŸ”¹ Aktueller Tarif' %}
  {% set t_status = 'Status:' %}
  {% set t_active = 'âœ… Aktiv' %}
  {% set t_cancelled = 'ğŸš« GekÃ¼ndigt' %}
  {% set t_pending = 'â³ Ausstehend' %}
  {% set t_exp = 'Ablaufdatum:' %}
  {% set t_no_exp = 'â€” Kein Ablaufdatum â€”' %}
  {% set t_upgrade = 'ğŸš€ Upgrade durchfÃ¼hren' %}
  {% set t_cancel = 'âŒ Abo kÃ¼ndigen' %}
  {% set t_basic = ['Bis zu 10 QR-Codes', 'Standard-Designs', 'Einfache Verwaltung'] %}
  {% set t_pro = ['Bis zu 50 QR-Codes', 'Alle Design-Stile', 'Logo- und Farboptionen'] %}
  {% set t_business = ['Bis zu 250 QR-Codes', 'API-Zugang', 'Teamverwaltung'] %}
{% endif %}
{% block title %}{{ t_title }}{% endblock %}

{% block content %}
<section class="billing-container">
  <h1>{{ t_h1 }}</h1>
  <p class="subtitle">{{ t_sub }}</p>

  <div class="billing-card">
    <h2>{{ t_current }}</h2>
    <p>
      <strong>{{ user.plan.name if user.plan else "Basic" }}</strong><br>
      {{ t_status }}
      {% if user.plan_status == "active" %}
        <span class="status active">{{ t_active }}</span>
      {% elif user.plan_status == "cancelled" %}
        <span class="status cancelled">{{ t_cancelled }}</span>
      {% else %}
        <span class="status pending">{{ t_pending }}</span>
      {% endif %}
      <br>
      {{ t_exp }}
      {% if user.plan_expiry %}
        {{ user.plan_expiry.strftime('%d.%m.%Y') }}
      {% else %}
        {{ t_no_exp }}
      {% endif %}
    </p>

    <div class="buttons">
      <a href="/billing/upgrade" class="btn primary">{{ t_upgrade }}</a>
      <a href="/billing/cancel" class="btn danger">{{ t_cancel }}</a>
    </div>
  </div>

  <div class="plans">
    <div class="plan">
      <h3>ğŸŸ¢ Basic</h3>
      <p>4,99 â‚¬ / Monat</p>
      <ul>
        <li>{{ t_basic[0] }}</li>
        <li>{{ t_basic[1] }}</li>
        <li>{{ t_basic[2] }}</li>
      </ul>
    </div>

    <div class="plan">
      <h3>ğŸŸ¡ Pro</h3>
      <p>14,99 â‚¬ / Monat</p>
      <ul>
        <li>{{ t_pro[0] }}</li>
        <li>{{ t_pro[1] }}</li>
        <li>{{ t_pro[2] }}</li>
      </ul>
    </div>

    <div class="plan">
      <h3>ğŸ”µ Business</h3>
      <p>29,99 â‚¬ / Monat</p>
      <ul>
        <li>{{ t_business[0] }}</li>
        <li>{{ t_business[1] }}</li>
        <li>{{ t_business[2] }}</li>
      </ul>
    </div>
  </div>
</section>

<style>
.billing-container {
  max-width: 850px;
  margin: 3rem auto;
  padding: 2rem;
  background: #fff;
  border-radius: 16px;
  box-shadow: 0 4px 20px rgba(0,0,0,0.05);
  font-family: "Inter", system-ui, sans-serif;
}
h1 { text-align:center; color:#0d2a78; margin-bottom:.5rem; }
.subtitle { text-align:center; color:#475569; margin-bottom:2rem; }
.billing-card {
  background:#f9fafb; padding:1.5rem; border-radius:12px; margin-bottom:2rem;
}
.status.active { color:#16a34a; font-weight:600; }
.status.cancelled { color:#dc2626; font-weight:600; }
.status.pending { color:#eab308; font-weight:600; }
.buttons { margin-top:1rem; display:flex; gap:1rem; flex-wrap:wrap; }
.btn {
  display:inline-block; padding:.7rem 1.4rem; border-radius:8px; text-decoration:none; font-weight:600;
}
.btn.primary { background:#0d2a78; color:white; }
.btn.primary:hover { background:#1e3a8a; }
.btn.danger { background:#dc2626; color:white; }
.btn.danger:hover { background:#b91c1c; }
.plans {
  display:grid; grid-template-columns:repeat(auto-fit,minmax(240px,1fr)); gap:1rem;
}
.plan {
  background:#f8fafc; border:1px solid #e2e8f0; border-radius:12px; padding:1rem; text-align:center;
}
.plan h3 { color:#0d2a78; }
.plan p { font-weight:600; margin:.5rem 0; }
.plan ul { list-style:none; padding:0; color:#475569; font-size:.95rem; }
.plan li { margin:.3rem 0; }
</style>
{% endblock %}
